clc;
clear;

for i = 1 : 285
    
 filename = sprintf ('Book2.xlsx');
 
 eval (sprintf ("may%d = xlsread (filename,'Sheet%d'); ",i,i));

map = [1 1 1;0.808627426624298 0.903529405593872 0.956078410148621;0.617254912853241 0.807058811187744 0.912156879901886;0.425882339477539 0.710588276386261 0.868235290050507;0.234509810805321 0.614117681980133 0.824313759803772;0.0431372560560703 0.517647087574005 0.780392169952393;0.0359477140009403 0.431372582912445 0.816993474960327;0.0287581700831652 0.345098048448563 0.853594779968262;0.0215686280280352 0.258823543787003 0.890196084976196;0.0143790850415826 0.172549024224281 0.926797389984131;0.00718954252079129 0.0862745121121407 0.963398694992065;0 0 1;0.0967320278286934 0.0544662326574326 0.888888895511627;0.193464055657387 0.108932465314865 0.777777791023254;0.290196090936661 0.163398697972298 0.666666686534882;0.386928111314774 0.21786493062973 0.555555582046509;0.483660131692886 0.272331148386002 0.444444447755814;0.580392181873322 0.326797395944595 0.333333343267441;0.677124202251434 0.381263613700867 0.222222223877907;0.773856222629547 0.43572986125946 0.111111111938953;0.87058824300766 0.490196079015732 0;0.88496732711792 0.546840965747833 0;0.89934641122818 0.603485822677612 0;0.91372549533844 0.660130739212036 0;0.9281045794487 0.716775596141815 0;0.94248366355896 0.773420453071594 0;0.95686274766922 0.830065369606018 0;0.97124183177948 0.886710226535797 0;0.98562091588974 0.943355143070221 0;1 1 0;0.960410833358765 0.976470589637756 0.0160597581416368;0.920821666717529 0.952941179275513 0.0321195162832737;0.881232500076294 0.929411768913269 0.0481792725622654;0.841643333435059 0.905882358551025 0.0642390325665474;0.802054166793823 0.882352948188782 0.0802987888455391;0.762465000152588 0.858823537826538 0.0963585451245308;0.722875833511353 0.835294127464294 0.112418301403522;0.683286666870117 0.811764717102051 0.128478065133095;0.643697500228882 0.788235306739807 0.144537821412086;0.604108333587646 0.764705896377563 0.160597577691078;0.564519166946411 0.74117648601532 0.17665733397007;0.524930000305176 0.717647075653076 0.192717090249062;0.485340803861618 0.694117665290833 0.208776846528053;0.445751637220383 0.670588254928589 0.224836602807045;0.406162470579147 0.647058844566345 0.240896359086037;0.366573303937912 0.623529434204102 0.25695613026619;0.326984137296677 0.600000023841858 0.273015886545181;0.287394970655441 0.576470613479614 0.289075642824173;0.247805789113045 0.552941203117371 0.305135399103165;0.208216622471809 0.529411792755127 0.321195155382156;0.168627455830574 0.505882382392883 0.337254911661148;0.232579186558723 0.466968357563019 0.311312228441238;0.296530932188034 0.428054332733154 0.285369545221329;0.360482662916183 0.38914030790329 0.259426862001419;0.424434393644333 0.350226253271103 0.233484163880348;0.488386124372482 0.311312228441238 0.207541480660439;0.552337884902954 0.272398203611374 0.181598797440529;0.616289615631104 0.233484178781509 0.155656114220619;0.680241346359253 0.194570153951645 0.12971343100071;0.744193077087402 0.155656114220619 0.103770740330219;0.808144807815552 0.116742089390755 0.0778280571103096;0.872096538543701 0.0778280571103096 0.0518853701651096;0.936048269271851 0.0389140285551548 0.0259426850825548;1 0 0];
colormap (map)
axes1 = axes('YScale','log','YMinorTick','on',...
    'YMinorGrid','on',...
    'XScale','log',...
    'XMinorTick','on',...
    'XMinorGrid','on',...
    'TickDir','out',...
    'MinorGridLineStyle','none',...
    'GridLineStyle','none',...
    'CLim',[0 1000],...
    'view', [90 90]);

%'XDir','reverse',...

xlim(axes1,[0 31]);   
ylim(axes1,[0 8193]);
%zlim(axes1,[0 LimZ]);
%title('NaOH');

%xlabel ('Input Sinyal (MHz)');
%ylabel ('Spektral Derau (MHz)');

view(axes1);
box(axes1,'on');
grid(axes1,'on');
hold(axes1,'all');

eval(sprintf("surf(may%d,'FaceLighting','Phong','FaceColor','interp','EdgeColor','none'); ",i));


colorbar('peer',axes1);

Image = getframe(gcf);
eval(sprintf("imwrite(Image.cdata, 'Campuran%d.png')",i)); 

close all

end
